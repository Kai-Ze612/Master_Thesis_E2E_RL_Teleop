controller_manager:
  ros__parameters:
    update_rate: 1000  # Hz

    # 1. Define the joint_state_broadcaster
    joint_state_broadcaster:
      type: "joint_state_broadcaster/JointStateBroadcaster"

    # 2. Define the franka_robot_state_broadcaster
    franka_robot_state_broadcaster:
      type: "franka_robot_state_broadcaster/FrankaRobotStateBroadcaster"

    # 3. Define the joint_tau_controller
    joint_tau_controller:
      # --- THIS IS THE FINAL, CORRECT TYPE ---
      # Use the controller from your "Available classes" list
      type: "franka_example_controllers/JointTauController"

#
# Configure the controllers
#

# Configure the joint_tau_controller
joint_tau_controller:
  ros__parameters:
    # --- THIS IS THE REQUIRED PARAM FOR THIS CONTROLLER ---
    arm_id: panda

    # --- THIS IS THE FIX FOR THE RACE CONDITION ---
    command_timeout: 3.0
    
    # List the joints it controls
    joints:
      - panda_joint1
      - panda_joint2
      - panda_joint3
      - panda_joint4
      - panda_joint5
      - panda_joint6
      - panda_joint7
      
    # Define the interfaces
    command_interfaces:
      - effort
    state_interfaces:
      - position
      - velocity